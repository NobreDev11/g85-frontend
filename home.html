<script>
  const BACKEND_URL = 'https://g85-backend.onrender.com';
  const token = localStorage.getItem('token');

  async function verificarToken() {
    if (!token) {
      alert('Você precisa estar logado.');
      window.location.href = 'index.html';
      return;
    }

    try {
      const res = await fetch(`${BACKEND_URL}/api/perfil`, {
        headers: {
          Authorization: `Bearer ${token}`
        }
      });

      if (!res.ok) throw new Error();

      const dados = await res.json();
        document.querySelector('h2').textContent = `Bem-vindo(a), ${dados.nome || 'Usuário'}`;
    } catch (err) {
      alert('Sessão expirada. Faça login novamente.');
      localStorage.clear();
      window.location.href = 'index.html';
    }
  }

  document.addEventListener('DOMContentLoaded', verificarToken);
</script>
